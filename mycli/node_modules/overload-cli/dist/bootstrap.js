"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const load_1 = tslib_1.__importDefault(require("./libs/load"));
const puppeteer_1 = tslib_1.__importDefault(require("./libs/puppeteer"));
const output_1 = tslib_1.__importDefault(require("./libs/output"));
const preview_1 = tslib_1.__importDefault(require("./libs/preview"));
const utils_1 = require("./utils");
const bootstrap = async (configPath) => {
    // 0. 共用参数设置
    const setSuccess = (0, utils_1.setCommonDirnames)();
    if (setSuccess !== true)
        return;
    // 1. 读取 config
    const { success: loadSuccess, data: skeletonConfig } = await load_1.default.initialize(configPath);
    if (loadSuccess !== true || !skeletonConfig)
        return;
    // 2. 启动 puppeteer，置换元素，生成截图
    const { success: puppeteerSuccess, data: screenshotData } = await puppeteer_1.default.initialize(skeletonConfig);
    if (puppeteerSuccess !== true || !screenshotData)
        return;
    // 3. 输出管理
    const runtimeContent = await output_1.default.initialize(screenshotData, skeletonConfig);
    if (!runtimeContent)
        return;
    // 4. 启动预览
    await preview_1.default.initialize(runtimeContent, skeletonConfig);
};
exports.default = bootstrap;
